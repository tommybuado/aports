# Contributor: Tommy Buado <tommy@thinkpad.local>
# Maintainer: Tommy Buado <tommy@thinkpad.local>
pkgname=dwm
pkgver=6.5
pkgrel=0
pkgdesc="A dynamic window manager for X"
url="https://dwm.suckless.org"
arch="all"
license="MIT"
depends="dmenu-virtual st-virtual"
makedepends="libxft-dev libx11-dev libxinerama-dev"
subpackages="$pkgname-doc"
options="!check" # no test suite
source="https://dl.suckless.org/dwm/dwm-$pkgver.tar.gz
	dwm.desktop
	config.h
	patches/0001-Make-dwm-run-autostart-scripts-before-entering-handl.patch
	patches/0002-Switch-focus-only-by-mouse-click-and-not-sloppy.patch
	patches/0003-Keep-layout-mwfact-barpos-and-nmaster-per-tag.patch
	patches/0004-Remove-unnecessary-window-tile-for-dwm.patch
	patches/0005-Always-display-monocle-symbol-if-the-layout-is-activ.patch
	patches/0006-Activate-window-as-response-to-client-requests-_NET_.patch
	patches/0007-Add-rule-option-to-switch-to-the-configured-tag-when.patch
	patches/0008-Allow-user-to-change-bar-height-that-respects-the-DP.patch
	patches/0009-Allow-colors-and-rectangle-drawings-for-dwm.patch"

provides="dwm-virtual"
provider_priority=100

prepare() {
	default_prepare
	sed -i -e "/CFLAGS/{s/-Os//;s/=/+=/}" \
		-e "/LDFLAGS/{s/=/+=/}" config.mk
	cp -pr "$srcdir"/config.h config.h
}

build() {
	make X11INC=/usr/include/X11 \
		X11LIB=/usr/lib/X11 \
		FREETYPEINC=/usr/include/freetype2
}

package() {
	make PREFIX=/usr DESTDIR="$pkgdir" install
	install -Dm644 "$srcdir"/dwm.desktop \
		-t "$pkgdir"/usr/share/xsessions/
}

sha512sums="
6cc3efd8d8a5e96517474fdcb1c1a6192fdf669c1bb02de6aea0a9f1a951360bf73c9576a5a0f06b00e2f839bacc304d60548d5ead0996bf46d82be4121ed248  dwm-6.5.tar.gz
8d8a3f3e2b285dfce17da9cf4173b4841d0d7465112a1b2478d417dfb9c0b37ae98542c710464fcf0fdbe8fcef5a502f88a88a115d5c1717cf429f84797337dd  dwm.desktop
e276b240c0979c0d752a383d39f0c3a74fbab3844e0eaa4c2915ebad4abac51512e90035747a30f794a3ae872afe42fe8bc7ccd10715fe7be0026519230930c0  config.h
7989f6296b5bd567e2e1c4e607dfd7f3641d96021d8b9d5ae46799676f9af4792cfb9cd622ee55283b1560912dc71524ded3ebfd1d62362631fd56b7b4055906  0001-Make-dwm-run-autostart-scripts-before-entering-handl.patch
030b687317f525ed1d54ec18a7182a18f4a798488d2a6f1b5f276824c14a48c0370e53341154ce236d691e140fbeebe02ff57fe542f8affd28bb74618c6b0f0f  0002-Switch-focus-only-by-mouse-click-and-not-sloppy.patch
622725f424015375123b280f76e85fc3e3df8dcdee15d5e959b43c6f86a4ce4c80bdc878a43518352c6991161760fb94eba0872286dcc785637692fe8affe90b  0003-Keep-layout-mwfact-barpos-and-nmaster-per-tag.patch
b575c59e0d7269b8f80dd1666f21cfccb348b1afebbdc5eb4bd72feb18bb01a4b56618d4c367ada15d97a8c01bde34c9bccfd92d2e73cdfd0ed8ab9e088697e1  0004-Remove-unnecessary-window-tile-for-dwm.patch
5388668f2d452b40bbe561e1afaf714509602a0c2dcc02b7c71bca764c2e6d6b22740337009cef72b06ace4035479070a8fa1411d29982823e8b55e0304556c8  0005-Always-display-monocle-symbol-if-the-layout-is-activ.patch
6cfb1fac7cf25c4c7a565f78a583b5ecd35134fb5b05e93f437ccfed62911daeeb95de2201155f7f095cb9d5f0edba4fe78aaf3e1d5de5fc1a015b770363cc22  0006-Activate-window-as-response-to-client-requests-_NET_.patch
d3faa20c373ba2f3be93b4bd6f63b2ddf50ce0842da41424c829ea42ae7c46198c880419c4f7154f544f80204a3ae90c73b0e143d7094687d6bfb1357b2527f7  0007-Add-rule-option-to-switch-to-the-configured-tag-when.patch
fb21ce5d3738f82d89589bf770864fdcb9c0a5c268fa0a851d917af2325ae44e846fe84bc4d03f98dab75922a5f0feac3ad27a9a19ab71b0b548e8234da00a6f  0008-Allow-user-to-change-bar-height-that-respects-the-DP.patch
c419d219a4efc6ac46685067fcea5a42e6964e1a7410c2f4f3e418d6520ef2773881c63405d8faafb66246385b22b3b022dc97b10dd56f616ae602b3e6bbb275  0009-Allow-colors-and-rectangle-drawings-for-dwm.patch
"
