# Contributor: Tommy Buado <tommy@thinkpad.local>
# Maintainer: Tommy Buado <tommy@thinkpad.local>
pkgname=dwm
pkgver=6.5
pkgrel=0
pkgdesc="A dynamic window manager for X"
url="https://dwm.suckless.org"
arch="all"
license="MIT"
depends="dmenu-virtual st-virtual"
makedepends="libxft-dev libx11-dev libxinerama-dev"
subpackages="$pkgname-doc"
options="!check" # no test suite
source="https://dl.suckless.org/dwm/dwm-$pkgver.tar.gz
	dwm.desktop
	patches/0001-Make-dwm-run-autostart-scripts-before-entering-handl.patch
	patches/0002-Switch-focus-only-by-mouse-click-and-not-sloppy.patch"

provides="dwm-virtual"
provider_priority=100

prepare() {
	default_prepare
	sed -i -e "/CFLAGS/{s/-Os//;s/=/+=/}" \
		-e "/LDFLAGS/{s/=/+=/}" config.mk
}

build() {
	make X11INC=/usr/include/X11 \
		X11LIB=/usr/lib/X11 \
		FREETYPEINC=/usr/include/freetype2
}

package() {
	make PREFIX=/usr DESTDIR="$pkgdir" install
	install -Dm644 "$srcdir"/dwm.desktop \
		-t "$pkgdir"/usr/share/xsessions/
}

sha512sums="
6cc3efd8d8a5e96517474fdcb1c1a6192fdf669c1bb02de6aea0a9f1a951360bf73c9576a5a0f06b00e2f839bacc304d60548d5ead0996bf46d82be4121ed248  dwm-6.5.tar.gz
8d8a3f3e2b285dfce17da9cf4173b4841d0d7465112a1b2478d417dfb9c0b37ae98542c710464fcf0fdbe8fcef5a502f88a88a115d5c1717cf429f84797337dd  dwm.desktop
7989f6296b5bd567e2e1c4e607dfd7f3641d96021d8b9d5ae46799676f9af4792cfb9cd622ee55283b1560912dc71524ded3ebfd1d62362631fd56b7b4055906  0001-Make-dwm-run-autostart-scripts-before-entering-handl.patch
030b687317f525ed1d54ec18a7182a18f4a798488d2a6f1b5f276824c14a48c0370e53341154ce236d691e140fbeebe02ff57fe542f8affd28bb74618c6b0f0f  0002-Switch-focus-only-by-mouse-click-and-not-sloppy.patch
"
