# Contributor: Tommy Buado <tommy@thinkpad.local>
# Maintainer: Tommy Buado <tommy@thinkpad.local>
pkgname=dmenu
pkgver=5.3
pkgrel=0
pkgdesc="A dynamic menu for X"
url="https://tools.suckless.org/dmenu/"
arch="all"
license="MIT"
makedepends="libx11-dev libxinerama-dev libxft-dev"
subpackages="$pkgname-doc"
options="!check" # no test suite
source="https://dl.suckless.org/tools/dmenu-$pkgver.tar.gz
	patches/0001-Highlight-the-individual-characters-of-matched-text.patch
	patches/0002-Allow-user-to-change-bar-height-that-respects-the-DP.patch
	patches/0003-Remove-navigation-arrows-and-format-configuration-fi.patch"

provides="dmenu-virtual"
provider_priority=100

prepare() {
	default_prepare
	sed -i -e "/CFLAGS/{s/-Os//;s/=/+=/}" \
		-e "/LDFLAGS/{s/=/+=/}" config.mk
}

build() {
	make X11INC=/usr/include/X11 \
		X11LIB=/usr/lib/X11 \
		FREETYPEINC=/usr/include/freetype2
}

package() {
	make PREFIX=/usr DESTDIR="$pkgdir" install
}

sha512sums="
60f758134063ad7f304fbb0785c66dddc21461e5e5014f8735cf6d5c95dc22a177f069d48101e633ddffe5bbefc1118a2bf8b31daaf7b6438fdf6fe1bcb5d61c  dmenu-5.3.tar.gz
4aa0c2d7ecf6eb20a2335bfb80c56791d8b8b6ac062119cdd12a521c6ab3ca21f7abadd0a5234fd0751e12ed48a7c90d076d020c35fd3e57dfd41cb1fd0abf8f  0001-Highlight-the-individual-characters-of-matched-text.patch
1864fad80fedc591bd50db775ca834a6e11e87d55c629279166bef4de6d45716aaf3f707807d3493711d9d8cf82d904aaf51ebc450fcbc4c0ce3db59f736c597  0002-Allow-user-to-change-bar-height-that-respects-the-DP.patch
1235a98c3f303f4712474fe219966767dacb41e7dc5cb5e0d175189c5460ec216684fc1fa5a60b0f0b4de36fbbb1e3490aa006e7b349865b3e31980bf6de6797  0003-Remove-navigation-arrows-and-format-configuration-fi.patch
"
